2.2.1 针对区域索引的代码说明
创世块增加position core/genesis.go type GenesisAccount struct {}
创世块写入数据库func (g *Genesis) ToBlock(db ethdb.Database) *types.Block存储创世块中的账户位置 statedb.SetPosition(addr, account.Position)
account添加position internal/ethapi/api.go获得账户位置GetPosition internal/ethapi/api.go
transaction添加position core\types\transaction.go
添加账户位置树 core/state_transition.go
添加区域状态树 /gtrie
添加区域状态数据库，缓存区域状态 regionstate,RStateDB core/regionstate/
miner添加区域状态信息 miner/worker.go makeCurrent
增加rstate功能 common/types.go
state_object.go、statedb.go 添加 SetAccountlist,SetTxlist,SetRplist,Set URRlist设定指定区域状态内容
2.2.2 针对树状多链的代码说明
添加树状属性 core/types/block.go type Header struct{}
增加分支同步方式 eth/downloader/modes.go BranchSync
节点中记录分支区块 core/blockchain.go type BlockChain struct{}
分支节点可以生成分支区块 internal/jsre/deps/web3.js var setBranchblock = new Method{}
分支区块写入区块链 internal/ethapi/api.go SetBranchBlock -> core/blockchain.go SetBranchBlockByRegion
根据regionid同步区块 eth/sync.go synchronise(peer *peer){}
为branchnode构建mrgionstate,mgtrie core/mrgionstate,mgtrie
为branchnode建立 getaccountbyregion,gettxbyregion,getreceiptbyregion方法 (api.go)
2.2.3 针对资产转移的代码说明
branchnode管理资产转移列表 core/asset_transfer_list.go
交易增加txtype属性 core/types/transaction.go type txdata struct{}
branchnode根据交易类型筛选 收到的交易 eth/handler.go-> handleMsg->NewBlockMsg2.2.2 针对树状多链的修改
